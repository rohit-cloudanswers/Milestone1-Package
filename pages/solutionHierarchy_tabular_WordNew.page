<apex:page standardController="Quote" extensions="AccountHierrachyReArch"  contentType="application/msWord#ImagineCommunicationsProposalForQuote-{!qt.QuoteNumber}.doc" standardStylesheets="false"  cache="true">
    <html xmlns:v="urn:schemas-microsoft-com:vml"
          xmlns:o="urn:schemas-microsoft-com:office:office"
          xmlns:w="urn:schemas-microsoft-com:office:word">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <apex:outputText value="{!WordPrintViewXML}" escape="false"/>
        <style>
        
            @page Section1 {
                mso-header:h1;
                mso-footer:f1;
            }
            div.Section1 {
                page:Section1;
            }
            p.MsoFooter, li.MsoFooter, div.MsoFooter {
                margin:0in;
                margin-bottom:.0001pt;
                mso-pagination:widow-orphan;
                tab-stops:center 3.0in right 6.0in;
            }   
            p.MsoHeader, li.MsoHeader, div.MsoHeader{
                margin:0in;
                margin-top:.0001pt;
                mso-pagination:widow-orphan;
                tab-stops:center 3.0in right 6.0in;            
            }     
            /*Below is the style to prevent the repetition of header and Footer.. Cheers!!!*/
            table#hrdftrtbl{
                margin:0in 0in 0in 9in;
            }            
        </style>    
        <body>
         <!-- <img src="/servlet/servlet.ImageServer?id=015e00000007gZA&oid=00De0000005OcSQ" width="100%" height="100%" /> -->
         <!--  <img width="124" height="54" src="/servlet/servlet.ImageServer?id=015e00000007gZA&oid=00De0000005OcSQ&lastMod=1404920124000"> </img> -->
     
            <div class="Section1"> 

                <!--Section1 div starts-->
                <!-- Page 1 starts -->
                <br/>
                <table>
                
                <tr>
                    <td>
                        <br/>
                        <b>Quote#:</b>{!qt.QuoteNumber} <b>Revision #:</b>{!qt.Quote_Version__c}<br/>
                        Effective Date: {!effDate}<br/>
                        Valid Through: {!vaildDate}<br/>
                        Payment Terms: 
                        <apex:outputPanel rendered="{!IF(qt.Account.Payment_Terms__c!=null,true,false)}">
                            {!qt.Account.Payment_Terms__c}
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!IF(qt.Account.Payment_Terms__c==null,true,false)}">
                            Net 30
                        </apex:outputPanel><br/>
                        Freight Terms:
                        <apex:outputPanel rendered="{!IF(qt.Account.Freight_Terms__c!=null,true,false)}">
                            {!qt.Account.Payment_Terms__c}
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!IF(qt.Account.Freight_Terms__c==null,true,false)}">
                            Ex Works Factory
                        </apex:outputPanel><br/><br/>
                    </td>
                </tr>
                 <tr>
                    <td width="50%">
                        <b>To:</b><br/>
                        <b>{!qt.Account.name}</b><br/>
                        {!qt.account.BillingStreet}<br/>
                        {!qt.account.BillingCity},&nbsp;{!qt.account.BillingState}<br/>
                        {!qt.account.BillingCountry}&nbsp;{!qt.account.BillingPostalCode}<br/>
                    </td>
                    <td width="30"/>
                    <td>
                        <b>From:</b><br/>
                        <b>{!qt.opportunity.owner.name}</b><br/>
                        <!--{!qt.opportunity.owner.title}<br/>-->
                        {!qt.opportunity.owner.street}<br/>
                        {!qt.opportunity.owner.city},&nbsp;{!qt.opportunity.owner.state}<br/>
                        {!qt.opportunity.owner.country}&nbsp;{!qt.opportunity.owner.PostalCode}<br/>
                    </td>
                </tr>
                </table><br/>
                <table>
                <tr>
                    <td>
                        Dear {!qt.Contact.name},<br/><br/>
                        Based on the discussions we have had and an analysis of your requirements, I am pleased to offer the attached proposal ({!qt.QuoteNumber}, Revision {!qt.Quote_Version__c}).<br/><br/>
                        Please review at your earliest convenience.<br/><br/>
                        Should you have any questions or require any additional information, please feel free to contact me.<br/><br/>
                        Sincerely,<br/><br/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>{!qt.opportunity.owner.name}</b><br/>
                        <!--{!qt.opportunity.owner.title}<br/>-->
                        <b>Imagine Communications</b><br/>
                        {!qt.opportunity.owner.street}<br/>
                        {!qt.opportunity.owner.city},&nbsp;{!qt.opportunity.owner.state}<br/>
                        {!qt.opportunity.owner.country}&nbsp;{!qt.opportunity.owner.PostalCode}<br/>
                        C : {!qt.opportunity.owner.mobilephone}<br/>
                        F : {!qt.opportunity.owner.fax}<br/>
                        E : {!qt.opportunity.owner.email}<br/>
                        <a><font color="blue">www.ImagineCommunications.com</font></a><br/><br/>
                    </td>
                </tr> 
                
                </table>              
                <br clear="all" style="page-break-before:always" />
                
                
                <!-- Page 2 Starts -->
                <br/>
                
 
                    <table>
                        <tr>
                            <td width="50%">
                                <b>Bill To:</b><br/>
                                {!qt.BillingName}<br/>
                                {!qt.BillingStreet}<br/>
                                {!qt.BillingCity},&nbsp;{!qt.BillingState}<br/>
                                {!qt.BillingCountry}&nbsp;{!qt.BillingPostalCode}<br/>
                                Attn: {!qt.Bill_To_Contact__r.name}
                            </td><td width="100"/>
                            <td width="50%">
                                <b>Ship To:</b><br/>
                                {!qt.ShippingName}<br/>
                                {!qt.ShippingStreet}<br/>
                                {!qt.ShippingCity},&nbsp;{!qt.ShippingState}<br/>
                                {!qt.ShippingCountry}&nbsp;{!qt.ShippingPostalCode}<br/>
                                Attn: {!qt.Ship_To_Contact__r.name}<br/>
                            </td>
                        </tr>
                    </table><br/>
                <center><b><font style="text-align:center;">Proposal Summary</font></b></center><br/>
                <!-- </font> -->
                <center>
                    <apex:outputPanel rendered="{!showDisc}">
                    <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0" width="100%">
                        <tr>
                            <th style="background-color:#D0D0D0;"></th>
                            <th style="background-color:#D0D0D0;">Total Price</th>
                        </tr>
                        <apex:repeat value="{!sols}" var="eachSol">
                            <tr>
                                <td>{!solIds[eachSol]}</td>
                                <td>{!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solVsAmount[eachSol]}"/></apex:outputText></td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td>
                                Discounts
                            </td>
                            <td>
                                ({!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!qtAmount}"/></apex:outputText>)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Total Quote Price 
                            </td>
                            <td>
                                {!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!qtAmountAfterDisc}"/></apex:outputText>
                            </td>
                        </tr>
                    </table>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!!showDisc}">
                    <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0" width="100%">
                        <tr>
                            <th style="background-color:#D0D0D0;"></th>
                            <th style="background-color:#D0D0D0;">Total Price</th>
                        </tr>
                        <apex:repeat value="{!sols}" var="eachSol">
                            <tr>
                                <td>{!solIds[eachSol]}</td>
                                <td>{!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solVsAmount[eachSol]}"/></apex:outputText></td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td>
                                Total Quote Price 
                            </td>
                            <td>
                                {!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solTotal}"/></apex:outputText>
                            </td>
                        </tr>
                    </table>
                    </apex:outputPanel>
                </center>
                <hr/><br/><br/>
                <!-- <textarea rows="25" cols="100">{!dToday}&#10;Quote Name: {!qName}</textarea> -->
        <!--   <apex:inputTextArea rows="25" cols="100" value="{!qt.UserEnteredData_Dummy__c}"/><br/> -->
            
             <table>
                <tr>
                    <td>
                        <font size="2">
                            Is the purchase of this equipment or services exempt from sales tax? YES or NO <br/>
                            If NO - sales tax will be added to your invoices at the rate assigned to the ship to address.<br/><br/>
                            If YES - Sales Tax Exemption Number ______________________________ COPY OF CERTIFICATE MUST BE ATTACHED<br/><br/>
                            Who can we contact regarding sales tax questions on behalf of your company?<br/><br/>
                            Name:_____________________________________<br/> <br/>
                            Phone Number: _____________________________ <br/><br/>
                        </font>
                    </td>
                </tr>
             </table>
     
                
                <br clear="all" style="page-break-before:always" />

                <!-- Page 3 Starts -->
                <br/>
                

                <center><b><font style="text-align:center;">Product and Pricing Details (All prices in {!qt.priceBook2.currencyisocode})</font></b></center><br/>
                <div class="treeNode">
                    <apex:outputPanel rendered="{!showDisc}">
                        <font size="2">
                          <table style="border: 1px solid black;">
                               <apex:repeat value="{!ObjectStructure}" var="pos" >
                                        <tr>
                                            <td width="10%">
                                                        <apex:outputPanel rendered="{!IF(pos.account.id != null,true,false)}">
                                                            <apex:outputPanel rendered="{!solIdVsRender[pos.account.id]}">
                                                                 <div style="background-color:#D0D0D0;vertical-align: middle; width:100%; height:20px;">
                                                                    <b>{!pos.account.name}</b><br/>
                                                                </div>  
                                                                <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0">  
                                                                        <tr bordercolor="gray">
                                                                            <th>Qty</th>
                                                                            <th>Part #</th>
                                                                            <th>Line item name</th>
                                                                            <th>Description</th>
                                                                            <th>List Price</th>
                                                                            <th>Disc %</th>
                                                                            <th>Total Price</th>
                                                                        </tr>                           
                                                                        <apex:repeat value="{!solIdVsQLitems[pos.account.id]}" var="qt">
                                                                            <apex:repeat value="{!qt}" var="q">
                                                                                <tr >
                                                                                    <td width="5%" style="vertical-align:top;">
                                                                                        <apex:outputPanel >
                                                                                            <apex:outputText value="{0, number, ###,###,###,##0}"><apex:param value="{!q.Quantity}"/></apex:outputText><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                    <td width="10%" style="vertical-align:top;"> 
                                                                                        <apex:outputPanel layout="block" style="overflow-wrap:break-word;width: 100px;">
                                                                                            <apex:outputText value="{!q.Part_No__c}"/><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                    <td width="15%" style="vertical-align:top;">
                                                                                        <apex:outputPanel rendered="{!If(q.product2.name != null,true,false)}">
                                                                                            <apex:outputText value="{!q.product2.name}"/><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                    <td width="35%" style="vertical-align:top;">
                                                                                        <apex:outputPanel >
                                                                                            <apex:outputText value="{!q.product2.Description}"/><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                    <td width="10%" style="vertical-align:top;">
                                                                                        <apex:outputPanel style="float:right;">
        <!--                                                                                    <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.subtotal}"/></apex:outputText><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                    <td width="10%" style="vertical-align:top;">
                                                                                        <apex:outputText value="{!q.Discount}" style="float:right;"/><br/>
                                                                                    </td>
                                                                                    <td width="15%" style="vertical-align:top;">
                                                                                        <apex:outputPanel style="float:right;">
        <!--                                                                                    <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.TotalPrice}"/></apex:outputText><br/>
                                                                                        </apex:outputPanel>
                                                                                    </td>
                                                                                </tr>
                                                                            </apex:repeat>
                                                                    </apex:repeat>
                                                                </table>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                </td>
                                        </tr>
                                </apex:repeat>
                            </table>
                            </font>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!!showDisc}">
                            <font size="2">
                              <table style="border: 1px solid black;">
                                   <apex:repeat value="{!ObjectStructure}" var="pos" >
                                            <tr>
                                                <td>
                                                            <apex:outputPanel rendered="{!IF(pos.account.id != null,true,false)}">
                                                                <apex:outputPanel rendered="{!solIdVsRender[pos.account.id]}">
                                                                     <div style="background-color:#D0D0D0;vertical-align: middle; width:100%; height:20px;">
                                                                        <b>{!pos.account.name}</b><br/>
                                                                    </div>  
                                                                    <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0" width="100%"> 
                                                                            <tr bordercolor="gray">
                                                                                <th>Qty</th>
                                                                                <th>Part #</th>
                                                                                <th>Line item name</th>
                                                                                <th>Description</th>
                                                                                <th>List Price</th>
                                                                                <th>Total Price</th>
                                                                            </tr>                           
                                                                            <apex:repeat value="{!solIdVsQLitems[pos.account.id]}" var="qt">
                                                                                <apex:repeat value="{!qt}" var="q">
                                                                                    <tr >
                                                                                        <td width="10%" style="vertical-align:top;">
                                                                                            <apex:outputPanel >
                                                                                                <apex:outputText value="{0, number, ###,###,###,##0}"><apex:param value="{!q.Quantity}"/></apex:outputText><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                        <td style="vertical-align:top;width: 100px;"> 
                                                                                            <apex:outputPanel layout="block" style="word-wrap:break-word;width: 100px;">
                                                                                                <apex:outputText value="{!q.Part_No__c}"/><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                        <td width="15%" style="vertical-align:top;">
                                                                                            <apex:outputPanel rendered="{!If(q.product2.name != null,true,false)}">
                                                                                                <apex:outputText value="{!q.product2.name}"/><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                        <td width="45%" style="vertical-align:top;">
                                                                                            <apex:outputPanel >
                                                                                                <apex:outputText value="{!q.product2.Description}"/><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                        <td width="10%" style="vertical-align:top;">
                                                                                            <apex:outputPanel style="float:right;">
        <!--                                                                                        <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.subtotal}"/></apex:outputText><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                        <td width="10%" style="vertical-align:top;">
                                                                                            <apex:outputPanel style="float:right;" >
        <!--                                                                                        <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.TotalPrice}"/></apex:outputText><br/>
                                                                                            </apex:outputPanel>
                                                                                        </td>
                                                                                    </tr>
                                                                                </apex:repeat>
                                                                        </apex:repeat>
                                                                    </table>
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                    </td>
                                            </tr>
                                    </apex:repeat>
                                </table>
                                </font>
                        </apex:outputPanel>
                </div><br/>
                
                
                <apex:outputPanel rendered="{!IF(itemsWithNoSolutions.size>0,true,false)}">
                <div style="background-color:#D0D0D0;vertical-align: middle; width:100%; height:20px;"><b>Line items with no solutions.</b></div> 
                    <apex:outputPanel rendered="{!showDisc}">
                        <font size="2">
                        <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0">  
                                        <tr bordercolor="gray">
                                            <th>Qty</th>
                                            <th>Part #</th>
                                            <th>Line item name</th>
                                            <th>Description</th>
                                            <th>List Price</th>
                                            <th>Disc %</th>
                                            <th>Total Price</th>
                                        </tr>   
                                        <apex:repeat value="{!itemsWithNoSolutions}" var="q">
                                            <tr >
                                                <td width="10%" style="vertical-align:top;">
                                                    <apex:outputPanel >
                                                        <apex:outputText value="{0, number, ###,###,###,##0}"><apex:param value="{!q.Quantity}"/></apex:outputText><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td tyle="vertical-align:top;width: 100px;"> 
                                                    <apex:outputPanel layout="block" style="word-wrap:break-word;width: 100px;">
                                                        <apex:outputText value="{!q.Part_No__c}"/><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td width="15%" style="vertical-align:top;">
                                                    <apex:outputPanel rendered="{!If(q.product2.name != null,true,false)}">
                                                        <apex:outputText value="{!q.product2.name}"/><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td width="35%" style="vertical-align:top;">
                                                    <apex:outputPanel >
                                                        <apex:outputText value="{!q.product2.Description}"/><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td width="10%" style="vertical-align:top;">
                                                    <apex:outputPanel style="float:right;">
        <!--                                                <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.subtotal}"/></apex:outputText><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td width="10%" style="vertical-align:top;">
                                                    <apex:outputPanel style="float:right;">
                                                        <apex:outputText value="{!q.Discount}"/><br/>
                                                    </apex:outputPanel>
                                                </td>
                                                <td width="10%" style="vertical-align:top;">
                                                    <apex:outputPanel style="float:right;">
        <!--                                                <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.TotalPrice}"/></apex:outputText><br/>
                                                    </apex:outputPanel>
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                </table>
                                </font>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!!showDisc}">
                                <font size="2">
                                 <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0"> 
                                    <tr bordercolor="gray">
                                        <th>Qty</th>
                                        <th>Part #</th>
                                        <th>Line item name</th>
                                        <th>Description</th>
                                        <th>List Price</th>
                                        <th>Total Price</th>
                                    </tr>   
                                    <apex:repeat value="{!itemsWithNoSolutions}" var="q">
                                        <tr >
                                            <td width="10%" style="vertical-align:top;">
                                                <apex:outputPanel >
                                                    <apex:outputText value="{0, number, ###,###,###,##0}"><apex:param value="{!q.Quantity}"/></apex:outputText><br/>
                                                </apex:outputPanel>
                                            </td>
                                            <td style="vertical-align:top;width: 100px;"> 
                                                <apex:outputPanel layout="block" style="word-wrap:break-word;width: 100px;">
                                                    <apex:outputText value="{!q.Part_No__c}"/><br/>
                                                </apex:outputPanel>
                                            </td>
                                            <td width="15%" style="vertical-align:top;">
                                                <apex:outputPanel rendered="{!If(q.product2.name != null,true,false)}">
                                                    <apex:outputText value="{!q.product2.name}"/><br/>
                                                </apex:outputPanel>
                                            </td>
                                            <td width="45%" style="vertical-align:top;">
                                                <apex:outputPanel >
                                                    <apex:outputText value="{!q.product2.Description}"/><br/>
                                                </apex:outputPanel>
                                            </td>
                                            <td width="10%" style="vertical-align:top;">
                                                    <apex:outputPanel style="float:right;">
        <!--                                                <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                            <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.subtotal}"/></apex:outputText><br/>
                                                    </apex:outputPanel>
                                            </td>
                                            <td width="10%" style="vertical-align:top;">
                                                <apex:outputPanel style="float:right;">
        <!--                                            <apex:outputText value="{!qt.priceBook2.currencyisocode}"/>&nbsp; -->
                                                        <apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!q.TotalPrice}"/></apex:outputText><br/>
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                    </apex:repeat>
                            </table>
                            </font>
                    </apex:outputPanel>
              </apex:outputPanel>
                     <br/><br/>

                <hr/><br/>                
                
                
                
                             
                <br clear="all" style="page-break-before:always" />

                <!-- Page 4 Starts -->
                <br/>
                

                <center>
                    <apex:outputPanel rendered="{!showDisc}">
                    <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0" width="100%">
                        <tr>
                            <th style="background-color:#D0D0D0;"></th>
                            <th style="background-color:#D0D0D0;">Total Price</th>
                        </tr>
                        <apex:repeat value="{!sols}" var="eachSol">
                            <tr>
                                <td>{!solIds[eachSol]}</td>
                                <td>{!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solVsAmount[eachSol]}"/></apex:outputText></td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td>
                                Discounts
                            </td>
                            <td>
                                ({!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!qtAmount}"/></apex:outputText>)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Total Quote Price 
                            </td>
                            <td>
                                {!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!qtAmountAfterDisc}"/></apex:outputText>
                            </td>
                        </tr>
                    </table>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!!showDisc}">
                    <table border="1" bordercolor="gray" cellpadding="10" cellspacing="0" width="100%">
                        <tr>
                            <th style="background-color:#D0D0D0;"></th>
                            <th style="background-color:#D0D0D0;">Total Price</th>
                        </tr>
                        <apex:repeat value="{!sols}" var="eachSol">
                            <tr>
                                <td>{!solIds[eachSol]}</td>
                                <td>{!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solVsAmount[eachSol]}"/></apex:outputText></td>
                            </tr>
                        </apex:repeat>
                        <tr>
                            <td>
                                Total Quote Price 
                            </td>
                            <td>
                                {!qt.priceBook2.currencyisocode}&nbsp;<apex:outputText value="{0, number, ###,###,###,##0.00}"><apex:param value="{!solTotal}"/></apex:outputText>
                            </td>
                        </tr>
                    </table>
                    </apex:outputPanel>
                </center>
                <apex:outputPanel rendered="{!!showType}" >
                    <font size="2">
                        This Quote, and any Order resulting from this Quote, is subject to the Standard Terms and Conditions of Sale for Imagine Communications which are located at http://www.imaginecommunications.com/company/legal-compliance/Terms-Conditions.aspx and which are incorporated herein by reference. The Standard Terms and Conditions of Sale for Imagine Communications shall apply to the exclusion of any other terms and conditions except where expressly agreed in writing and signed by Imagine Communications. For a hardcopy of these terms and conditions, please call (U.S.) 303-476-5000, fax your request to 303-476-5025, or email your request to ICcontracts@imaginecommunications.com.  If Services are included in this Quote, or any Order resulting from this Quote, performance of the Services are subject to the Statement of Work as attached to this Quote and which is incorporated herein by reference, the Standard Terms and Conditions and the Statement of Work constitute the entire agreement of the parties with respect to the responsibilities and services to be performed by each party for the commissioning and implementation of the equipment and software as defined herein.  Capitalized terms not otherwise defined herein shall have the meanings ascribed to them in the Imagine Communications Standard Terms and Conditions of Sale.  In the event of a conflict between the terms of the attached Statement of Work and the Imagine Communications Standard Terms and Conditions of Sale, the terms of the Statement of Work will prevail.
                        <hr/><br/>
                        As a part of its marketing efforts, Imagine Communications may publish general information about this order including customer name, solutions acquired, application for which the solutions are intended, and deal value.  Imagine Communications will not publicize specific prices or other specific Confidential Information.
                        <br/><br/>
                        ___  I do not authorize Imagine Communications to publicize this order.<br/>
                        Imagine Communications Approval:            ________________________________________
                                                           Sales Persons  name  <br/>
                        
                        <br/>Customer Approval:     ________________________________________    <br/>
                        
                        Title:      ________________________________________    <br/>
                        
                        Date:   ________________________________________<br/>
                        
                        Purchase Order #:   ________________________________________<br/>       <br/>
                        
                        <b>Email signed quote to</b>    <br/>
                            
                        <a>NA-Orders@imaginecommunications.com</a><br/>
                        <a>EMEA-Orders@imaginecomminucations.com</a><br/>
                        <a>ASIA-Orders@imaginecommunications.com</a><br/>
                        <a>CALA-Orders@imaginecommunications.com</a><br/>
                    </font>
                </apex:outputPanel>
            
                <!--Header and Footer Starts-->
                <!--Header and Footer Starts-->
                <table id='hrdftrtbl' border='1' cellspacing='0' cellpadding='0'>
                    <tr>
                        <td>
                            <!--Header-->
                            <div style='mso-element:header' id="h1" >
                                <p class="MsoHeader">
                                    <table border="0.25" width="100%">
                                        <tr>
                                            <td width="40%"> 
                                                <img width="124" height="54" src="{!SiteUrl}"> </img>
                                                <!-- &oid=00De0000005OcSQ&lastMod=1404920124000 -->
                                                <br/> 
                                              <!--   <img src="/servlet/servlet.ImageServer?id=015e00000007gZA&oid=00De0000005OcSQ" width="100%" height="100%" /> -->
                                              <!--  <img src="/servlet/servlet.FileDownload?file=015e00000007gZA" width="100%" height="100%"></img>  -->
                                              <!-- <img src="/servlet/servlet.FileDownload?file=015e00000007kPi" width="100%" height="100%"></img> -->
                                              <!-- https://YOURINSTANCE.salesforce.com/servlet/servlet.ImageServer?id=SOMEID&oid=SOMEID&lastMod=SOMEID -->
                                            </td>
                                        </tr> 
                                        <tr>    
                                            <td align="left" width="40%">
                                                <b>Imagine Communications Corp.</b> 
                                            </td>
                                            <td align="right" width="40%">
                                                <a href="#"><font color="blue" family="Arial" size="3">www.ImagineCommunications.com</font></a>
                                            </td>
                                        </tr>
                                    </table>
                                </p>
                            </div>
                        </td>

                        <td>
                            <!--Footer-->
                            <div style='mso-element:footer' id="f1">
                                <p class="MsoFooter">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                        <tr>
                                            <td width="30%">
                                                © 2014 Imagine Communications Corp.
                                            </td>
                                            <td align="right" width="30%">
                                                Page <span style='mso-field-code: PAGE '></span> of <span style='mso-field-code: NUMPAGES '></span>
                                            </td>
                                        </tr>
                                    </table>
                                </p>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>                            
        </body>  
    </html>  
</apex:page>