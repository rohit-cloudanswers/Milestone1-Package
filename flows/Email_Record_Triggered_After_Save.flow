<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Ask_Tier1_to_Check</name>
        <label>Ask Tier1 to Check</label>
        <locationX>477</locationX>
        <locationY>901</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <inputParameters>
            <name>text</name>
            <value>
                <elementReference>textTier1ChatterMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>$Record.Parent.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>visibility</name>
            <value>
                <stringValue>internalUsers</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Let_Owner_Know</name>
        <label>Let Owner Know</label>
        <locationX>874</locationX>
        <locationY>816</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <inputParameters>
            <name>text</name>
            <value>
                <elementReference>textInformOwner</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>$Record.Parent.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>visibility</name>
            <value>
                <stringValue>internalUsers</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <name>Let_Owner_Know_0</name>
        <label>Let Owner Know</label>
        <locationX>1046</locationX>
        <locationY>1001</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <connector>
            <targetReference>Update_Case</targetReference>
        </connector>
        <inputParameters>
            <name>text</name>
            <value>
                <elementReference>textInformOwner</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>$Record.Parent.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>visibility</name>
            <value>
                <stringValue>internalUsers</stringValue>
            </value>
        </inputParameters>
    </actionCalls>
    <assignments>
        <name>Case_to_Closed</name>
        <label>Case to Closed</label>
        <locationX>1299</locationX>
        <locationY>872</locationY>
        <assignmentItems>
            <assignToReference>Case_Record.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Closed</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Case</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Case_to_Open</name>
        <label>Case to Open</label>
        <locationX>1035</locationX>
        <locationY>872</locationY>
        <assignmentItems>
            <assignToReference>Case_Record.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Open</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Let_Owner_Know_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Do_nothing_at_all</name>
        <label>Do nothing at all</label>
        <locationX>1676</locationX>
        <locationY>623</locationY>
        <assignmentItems>
            <assignToReference>varNothing</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Nothing</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Grab_Record_Type_Name</name>
        <label>Grab Record Type Name</label>
        <locationX>686</locationX>
        <locationY>623</locationY>
        <assignmentItems>
            <assignToReference>varRecordTypeName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Case_Record.RecordType.DeveloperName</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_Record_Type</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Content_Keywords</name>
        <label>Content Keywords</label>
        <locationX>466</locationX>
        <locationY>747</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Body_contains_Urgent</name>
            <conditionLogic>(1 OR 2 OR 3) AND 4 AND 5</conditionLogic>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Urgent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>ASAP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Critical</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Case_Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Case_Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Service</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Ask_Tier1_to_Check</targetReference>
            </connector>
            <label>Body contains Urgent</label>
        </rules>
    </decisions>
    <decisions>
        <name>LicenseRequest_Type_Check_Keywords</name>
        <label>LicenseRequest Type - Check Keywords</label>
        <locationX>1167</locationX>
        <locationY>752</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>STATUS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>STATUS</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>License_Request</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Let_Owner_Know</targetReference>
            </connector>
            <label>STATUS</label>
        </rules>
        <rules>
            <name>ISSUE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>ISSUE</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>License_Request</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_to_Open</targetReference>
            </connector>
            <label>ISSUE</label>
        </rules>
        <rules>
            <name>CLOSE</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.TextBody</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>CLOSE</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>License_Request</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_to_Closed</targetReference>
            </connector>
            <label>CLOSE</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_Record_Type</name>
        <label>What Record Type?</label>
        <locationX>686</locationX>
        <locationY>743</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Service</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Service</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Content_Keywords</targetReference>
            </connector>
            <label>Service</label>
        </rules>
        <rules>
            <name>License_Request</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varRecordTypeName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>License_Request</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>LicenseRequest_Type_Check_Keywords</targetReference>
            </connector>
            <label>License Request</label>
        </rules>
    </decisions>
    <description>Fun and Games with email routing.  Because everyone wants everything and nobody wants to call.

Check record type matching</description>
    <interviewLabel>Email - Record Triggered - After Save {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Email - Record Triggered - After Save</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <description>get the case first because we&apos;re going to be using it everywhere</description>
        <name>Case_Record</name>
        <label>Case Record</label>
        <locationX>686</locationX>
        <locationY>503</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Grab_Record_Type_Name</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Do_nothing_at_all</targetReference>
        </faultConnector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ParentId</elementReference>
            </value>
        </filters>
        <object>Case</object>
    </recordLookups>
    <recordLookups>
        <name>ChatterGroup</name>
        <label>ChatterGroup</label>
        <locationX>686</locationX>
        <locationY>383</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Case_Record</targetReference>
        </connector>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>CSR</stringValue>
            </value>
        </filters>
        <object>CollaborationGroup</object>
    </recordLookups>
    <recordLookups>
        <description>checking to see if this is the only email record on the case.  apparently just checking for new status wasn&apos;t enough and there were too many notifications</description>
        <name>Email_Records</name>
        <label>Email Records</label>
        <locationX>310</locationX>
        <locationY>819</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <filters>
            <field>ParentId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Case_Record.Id</elementReference>
            </value>
        </filters>
        <object>EmailMessage</object>
    </recordLookups>
    <recordUpdates>
        <name>Update_Case</name>
        <label>Update Case</label>
        <locationX>1179</locationX>
        <locationY>1118</locationY>
        <inputReference>Case_Record</inputReference>
    </recordUpdates>
    <startElementReference>ChatterGroup</startElementReference>
    <status>Draft</status>
    <textTemplates>
        <name>textInformOwner</name>
        <text>Hi @[{!Case_Record.OwnerId}].&amp;nbsp;The requester is looking for an update on this License Request.  Please follow up.</text>
    </textTemplates>
    <textTemplates>
        <name>textTier1ChatterMessage</name>
        <text>Hi @[{!ChatterGroup.Id}] this is your friendly automation.  This email contains words that suggest it may be a critical issue, could you give it a human eye?#[Possible Critical Emails]
#[Possible Critical Emails]</text>
    </textTemplates>
    <variables>
        <name>varNothing</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varRecordTypeName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue></stringValue>
        </value>
    </variables>
</Flow>
